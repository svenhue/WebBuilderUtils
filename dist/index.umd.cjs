(function(a,W){typeof exports=="object"&&typeof module<"u"?W(exports,require("pinia"),require("vue"),require("axios"),require("inversify"),require("lodash-es"),require("vue-router"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","pinia","vue","axios","inversify","lodash-es","vue-router","quasar"],W):(a=typeof globalThis<"u"?globalThis:a||self,W(a.alphautils={},a.pinia,a.vue,a.axios,a.inversify,a["lodash-es"],a["vue-router"],a.quasar))})(this,function(a,W,S,yt,O,ve,je,Me){"use strict";var De=typeof document<"u"?document.currentScript:null,Ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */var Be;(function(i){(function(e){var t=typeof Ne=="object"?Ne:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=r(i);typeof t.Reflect>"u"?t.Reflect=i:n=r(t.Reflect,n),e(n);function r(o,s){return function(f,p){typeof o[f]!="function"&&Object.defineProperty(o,f,{configurable:!0,writable:!0,value:p}),s&&s(f,p)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",r=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",f={__proto__:[]}instanceof Array,p=!s&&!f,g={create:s?function(){return Te(Object.create(null))}:f?function(){return Te({__proto__:null})}:function(){return Te({})},has:p?function(c,l){return t.call(c,l)}:function(c,l){return l in c},get:p?function(c,l){return t.call(c,l)?c[l]:void 0}:function(c,l){return c[l]}},P=Object.getPrototypeOf(Function),D=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",T=!D&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:mi(),j=!D&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:gi(),M=!D&&typeof WeakMap=="function"?WeakMap:bi(),B=new M;function J(c,l,u,d){if(N(u)){if(!vt(c))throw new TypeError;if(!mt(l))throw new TypeError;return L(c,l)}else{if(!vt(c))throw new TypeError;if(!R(l))throw new TypeError;if(!R(d)&&!N(d)&&!le(d))throw new TypeError;return le(d)&&(d=void 0),u=Z(u),k(c,l,u,d)}}e("decorate",J);function Q(c,l){function u(d,m){if(!R(d))throw new TypeError;if(!N(m)&&!di(m))throw new TypeError;pe(c,l,d,m)}return u}e("metadata",Q);function q(c,l,u,d){if(!R(u))throw new TypeError;return N(d)||(d=Z(d)),pe(c,l,u,d)}e("defineMetadata",q);function he(c,l,u){if(!R(l))throw new TypeError;return N(u)||(u=Z(u)),H(c,l,u)}e("hasMetadata",he);function ne(c,l,u){if(!R(l))throw new TypeError;return N(u)||(u=Z(u)),Y(c,l,u)}e("hasOwnMetadata",ne);function v(c,l,u){if(!R(l))throw new TypeError;return N(u)||(u=Z(u)),ie(c,l,u)}e("getMetadata",v);function y(c,l,u){if(!R(l))throw new TypeError;return N(u)||(u=Z(u)),U(c,l,u)}e("getOwnMetadata",y);function C(c,l){if(!R(c))throw new TypeError;return N(l)||(l=Z(l)),ce(c,l)}e("getMetadataKeys",C);function _(c,l){if(!R(c))throw new TypeError;return N(l)||(l=Z(l)),ht(c,l)}e("getOwnMetadataKeys",_);function E(c,l,u){if(!R(l))throw new TypeError;N(u)||(u=Z(u));var d=F(l,u,!1);if(N(d)||!d.delete(c))return!1;if(d.size>0)return!0;var m=B.get(l);return m.delete(u),m.size>0||B.delete(l),!0}e("deleteMetadata",E);function L(c,l){for(var u=c.length-1;u>=0;--u){var d=c[u],m=d(l);if(!N(m)&&!le(m)){if(!mt(m))throw new TypeError;l=m}}return l}function k(c,l,u,d){for(var m=c.length-1;m>=0;--m){var G=c[m],w=G(l,u,d);if(!N(w)&&!le(w)){if(!R(w))throw new TypeError;d=w}}return d}function F(c,l,u){var d=B.get(c);if(N(d)){if(!u)return;d=new T,B.set(c,d)}var m=d.get(l);if(N(m)){if(!u)return;m=new T,d.set(l,m)}return m}function H(c,l,u){var d=Y(c,l,u);if(d)return!0;var m=xe(l);return le(m)?!1:H(c,m,u)}function Y(c,l,u){var d=F(l,u,!1);return N(d)?!1:li(d.has(c))}function ie(c,l,u){var d=Y(c,l,u);if(d)return U(c,l,u);var m=xe(l);if(!le(m))return ie(c,m,u)}function U(c,l,u){var d=F(l,u,!1);if(!N(d))return d.get(c)}function pe(c,l,u,d){var m=F(u,d,!0);m.set(c,l)}function ce(c,l){var u=ht(c,l),d=xe(c);if(d===null)return u;var m=ce(d,l);if(m.length<=0)return u;if(u.length<=0)return m;for(var G=new j,w=[],A=0,b=u;A<b.length;A++){var I=b[A],x=G.has(I);x||(G.add(I),w.push(I))}for(var K=0,bt=m;K<bt.length;K++){var I=bt[K],x=G.has(I);x||(G.add(I),w.push(I))}return w}function ht(c,l){var u=[],d=F(c,l,!1);if(N(d))return u;for(var m=d.keys(),G=fi(m),w=0;;){var A=pi(G);if(!A)return u.length=w,u;var b=hi(A);try{u[w]=b}catch(I){try{vi(G)}finally{throw I}}w++}}function pt(c){if(c===null)return 1;switch(typeof c){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return c===null?1:6;default:return 6}}function N(c){return c===void 0}function le(c){return c===null}function si(c){return typeof c=="symbol"}function R(c){return typeof c=="object"?c!==null:typeof c=="function"}function ai(c,l){switch(pt(c)){case 0:return c;case 1:return c;case 2:return c;case 3:return c;case 4:return c;case 5:return c}var u=l===3?"string":l===5?"number":"default",d=gt(c,r);if(d!==void 0){var m=d.call(c,u);if(R(m))throw new TypeError;return m}return ci(c,u==="default"?"number":u)}function ci(c,l){if(l==="string"){var u=c.toString;if(ue(u)){var d=u.call(c);if(!R(d))return d}var m=c.valueOf;if(ue(m)){var d=m.call(c);if(!R(d))return d}}else{var m=c.valueOf;if(ue(m)){var d=m.call(c);if(!R(d))return d}var G=c.toString;if(ue(G)){var d=G.call(c);if(!R(d))return d}}throw new TypeError}function li(c){return!!c}function ui(c){return""+c}function Z(c){var l=ai(c,3);return si(l)?l:ui(l)}function vt(c){return Array.isArray?Array.isArray(c):c instanceof Object?c instanceof Array:Object.prototype.toString.call(c)==="[object Array]"}function ue(c){return typeof c=="function"}function mt(c){return typeof c=="function"}function di(c){switch(pt(c)){case 3:return!0;case 4:return!0;default:return!1}}function gt(c,l){var u=c[l];if(u!=null){if(!ue(u))throw new TypeError;return u}}function fi(c){var l=gt(c,o);if(!ue(l))throw new TypeError;var u=l.call(c);if(!R(u))throw new TypeError;return u}function hi(c){return c.value}function pi(c){var l=c.next();return l.done?!1:l}function vi(c){var l=c.return;l&&l.call(c)}function xe(c){var l=Object.getPrototypeOf(c);if(typeof c!="function"||c===P||l!==P)return l;var u=c.prototype,d=u&&Object.getPrototypeOf(u);if(d==null||d===Object.prototype)return l;var m=d.constructor;return typeof m!="function"||m===c?l:m}function mi(){var c={},l=[],u=function(){function w(A,b,I){this._index=0,this._keys=A,this._values=b,this._selector=I}return w.prototype["@@iterator"]=function(){return this},w.prototype[o]=function(){return this},w.prototype.next=function(){var A=this._index;if(A>=0&&A<this._keys.length){var b=this._selector(this._keys[A],this._values[A]);return A+1>=this._keys.length?(this._index=-1,this._keys=l,this._values=l):this._index++,{value:b,done:!1}}return{value:void 0,done:!0}},w.prototype.throw=function(A){throw this._index>=0&&(this._index=-1,this._keys=l,this._values=l),A},w.prototype.return=function(A){return this._index>=0&&(this._index=-1,this._keys=l,this._values=l),{value:A,done:!0}},w}();return function(){function w(){this._keys=[],this._values=[],this._cacheKey=c,this._cacheIndex=-2}return Object.defineProperty(w.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),w.prototype.has=function(A){return this._find(A,!1)>=0},w.prototype.get=function(A){var b=this._find(A,!1);return b>=0?this._values[b]:void 0},w.prototype.set=function(A,b){var I=this._find(A,!0);return this._values[I]=b,this},w.prototype.delete=function(A){var b=this._find(A,!1);if(b>=0){for(var I=this._keys.length,x=b+1;x<I;x++)this._keys[x-1]=this._keys[x],this._values[x-1]=this._values[x];return this._keys.length--,this._values.length--,A===this._cacheKey&&(this._cacheKey=c,this._cacheIndex=-2),!0}return!1},w.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=c,this._cacheIndex=-2},w.prototype.keys=function(){return new u(this._keys,this._values,d)},w.prototype.values=function(){return new u(this._keys,this._values,m)},w.prototype.entries=function(){return new u(this._keys,this._values,G)},w.prototype["@@iterator"]=function(){return this.entries()},w.prototype[o]=function(){return this.entries()},w.prototype._find=function(A,b){return this._cacheKey!==A&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=A)),this._cacheIndex<0&&b&&(this._cacheIndex=this._keys.length,this._keys.push(A),this._values.push(void 0)),this._cacheIndex},w}();function d(w,A){return w}function m(w,A){return A}function G(w,A){return[w,A]}}function gi(){return function(){function c(){this._map=new T}return Object.defineProperty(c.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),c.prototype.has=function(l){return this._map.has(l)},c.prototype.add=function(l){return this._map.set(l,l),this},c.prototype.delete=function(l){return this._map.delete(l)},c.prototype.clear=function(){this._map.clear()},c.prototype.keys=function(){return this._map.keys()},c.prototype.values=function(){return this._map.values()},c.prototype.entries=function(){return this._map.entries()},c.prototype["@@iterator"]=function(){return this.keys()},c.prototype[o]=function(){return this.keys()},c}()}function bi(){var c=16,l=g.create(),u=d();return function(){function b(){this._key=d()}return b.prototype.has=function(I){var x=m(I,!1);return x!==void 0?g.has(x,this._key):!1},b.prototype.get=function(I){var x=m(I,!1);return x!==void 0?g.get(x,this._key):void 0},b.prototype.set=function(I,x){var K=m(I,!0);return K[this._key]=x,this},b.prototype.delete=function(I){var x=m(I,!1);return x!==void 0?delete x[this._key]:!1},b.prototype.clear=function(){this._key=d()},b}();function d(){var b;do b="@@WeakMap@@"+A();while(g.has(l,b));return l[b]=!0,b}function m(b,I){if(!t.call(b,u)){if(!I)return;Object.defineProperty(b,u,{value:g.create()})}return b[u]}function G(b,I){for(var x=0;x<I;++x)b[x]=Math.random()*255|0;return b}function w(b){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(b)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(b)):G(new Uint8Array(b),b):G(new Array(b),b)}function A(){var b=w(c);b[6]=b[6]&79|64,b[8]=b[8]&191|128;for(var I="",x=0;x<c;++x){var K=b[x];(x===4||x===6||x===8)&&(I+="-"),K<16&&(I+="0"),I+=K.toString(16).toLowerCase()}return I}}function Te(c){return c.__=void 0,delete c.__,c}})})(Be||(Be={}));class Ct{constructor(){this.name="UtilityModule",this.ressources=[]}InitializeServices(){}}var Re=(i=>(i["Connect Data"]="Connect Data",i["Use Javascript"]="Use Javascript",i["Use Array"]="Use Array",i["Demo Data"]="Demo Data",i))(Re||{});class Ve{constructor(e,t){this.key=e,this.value=t}}class Ce{constructor(e){this.keyValuePairs=e??new Array}add(e,t){this.keyValuePairs.push(new Ve(e,t))}get(e){let t=null;return this.keyValuePairs.forEach(n=>{n.key==e&&(t=n.value)}),t}setValue(e,t){const n=this.keyValuePairs.find(r=>r.key==e);n?n.value=t:this.add(e,t)}remove(e){this.keyValuePairs.forEach((t,n)=>{t.key==e&&this.keyValuePairs.splice(n,1)})}toObject(){const e={};return this.keyValuePairs.forEach(t=>{e[t.key]=t.value}),e}}function Ge(i){let e=0;const t=i.map(n=>n);return t.length==0?e=0:e=Math.max(...t)+1,e}function $e(i,e,t){for(var n=i.length,r=-1;t--&&r++<n&&(r=i.indexOf(e,r),!(r<0)););return r}const me=W.defineStore("creator",{state:()=>({creations:Array(),avaiblecreationtypes:[{name:"diagram",subtypes:[{name:"Dont specify notation",suffix:"diagram"},{name:"Business Process Modelling Notation (bpmn)",suffix:"bpmn"},{name:"Unified Modelling Language (uml)",suffix:"uml"},{name:"Entity Relationship Diagram (erm)",suffix:"erm"},{name:"Decision Model (dmn)",suffix:"dmn"}]}],avaiblenotations:[{name:"bpmn"}]}),getters:{getSubTypeNames:i=>i.avaiblecreationtypes.map(e=>e.subtypes.map(t=>t.name)).flat(),getallCreations:i=>i.creations,getActiveCreations:i=>i.creations.filter(e=>e.active),getSolutionByContext:i=>e=>i.creations.find(t=>t.sessioncontextid==e)},actions:{addCreation(i){this.creations.push(i)}}}),we=W.defineStore("modellingstore",{state:()=>({focussedElements:[],registeredmodellingcontexts:[],currentcontext:-1,currentAction:""}),getters:{getScopedSolution(){return me(W.getActivePinia()).getSolutionByContext(this.currentcontext)},getSolutionModel(){var e;const i=this.getScopedSolution;return(e=z().getContextWebNodes(i==null?void 0:i.sessioncontextid).value)==null?void 0:e.filter(t=>t.type.includes(i.type))},getcurrentcontextid:i=>i.currentcontext,getcurrentcontext:i=>z().webnodecontexts.find(e=>e.contextid===i.currentcontext),getavaibleNotations(){const i=[];return this.getall.map(e=>{var t;if(e.type!=null){const n=(t=e.type)==null?void 0:t.indexOf(":");i.includes(e.type.slice(0,n))||i.push(e.type.slice(0,n))}}),i},getsubtypes(){return i=>{const e=[];return this.getavaibleModellingElements.map(t=>{if(t.type!=null&&t.type.includes(i)){let n=t.type.replace(i+":","");const r=n.indexOf(":");r!=-1&&(n=n.slice(0,r)),e.includes(n)||e.push(n)}}),e}},getmodell:()=>i=>{var n;const t=me(W.getActivePinia()).$state.avaiblenotations;return(n=z().getContextWebNodes(i).value)==null?void 0:n.filter(r=>{if(typeof r.type=="string"){for(const o of t)if(r.type.includes(o.name))return!0}return!1})},getFirstFocussedElement:i=>e=>{var t;return z().byId(e,(t=i.focussedElements.find(n=>n.contextid==e))==null?void 0:t.elements[0])},getfocussedElementsIds:i=>e=>{var t;return(t=i.focussedElements.find(n=>n.contextid==e))==null?void 0:t.elements},getfocussedElements:i=>e=>{var n,r;const t=(n=i.focussedElements.find(o=>o.contextid==e))==null?void 0:n.elements;return(r=z().getContextWebNodes(e).value)==null?void 0:r.filter(o=>t==null?void 0:t.includes(o.id))},getTypeRelatedElements(){return(i,e)=>this.getavaibleModellingElements.filter(t=>{var n;return(n=t.type)==null?void 0:n.includes(i.substring(0,$e(i,":",e)))})}},actions:{}});function Se(i,e,t,n,r){const o=Array.isArray(n)?n:[n];let s=[];for(let f=0;f<(i==null?void 0:i.length);f++){const p=i[f];if(o.includes(p[t])&&s.push(p),Array.isArray(p[e])){const g=Se(p[e],e,t,o);g!=null&&(s=s.concat(g))}}return s.length===0?null:s.length===1&&(r==null?void 0:r.array)!=!0?s[0]:s}const z=W.defineStore("webnodecontext",()=>{const i=S.ref(Array()),e=S.ref(Array());function t(v,y){return S.computed(()=>{var C,_;return y?(C=i.value.find(E=>E.optionaluniquename==y))==null?void 0:C.webnodes:(_=i.value.find(E=>E.contextid==v))==null?void 0:_.webnodes})}function n(v,y,C){return S.computed(()=>r(v,y).value.webnodes.filter(E=>C.includes(E.type)))}function r(v,y){return S.computed(()=>v!=null?i.value.find(C=>C.contextid==v):i.value.find(C=>C.optionaluniquename==y))}function o(v,y){return S.computed(()=>v==null?void 0:v.nodetree.find(C=>C.id===y))}function s(v,y){return S.computed(()=>{var _,E,L;const C=(E=(_=i.value.find(k=>k.contextid==v))==null?void 0:_.webnodes)==null?void 0:E.find(k=>k.id==y);return C??Se((L=i.value.find(k=>k.contextid==v))==null?void 0:L.webnodes,"children","id",y)})}function f(v,y,C){return S.computed(()=>{var _;return(_=i.value.find(E=>E.contextid==v))==null?void 0:_.webnodes.find(E=>E[y]==C)})}function p(v,y){return S.computed(()=>{var C;return(C=i.value.find(_=>_.contextid==v))==null?void 0:C.webnodes.filter(_=>_.parent==y)})}function g(v,y){return S.computed(()=>v==null?void 0:v.webnodes.filter(C=>C.parentId=C.id))}function P(v){const y=Ge(i.value.map(_=>_.contextid)),C=new WebNodeContextContainer(y);return C.optionaluniquename=v,i.value.push(C),y}function D(v){const y=i.value.findIndex(_=>_.contextid==v);let C=i.value[y].contextid;try{i.value.splice(y,1)}catch(_){C=_}return C}function T(v,y,C,_){const E=s(v,y);Q(C,E);const L=Q,k=M,F=s;function H(Y){var ie,U;if(((ie=Y.children)==null?void 0:ie.length)>=0)for(const pe of Y.children){const ce=F(v,pe);L(C,ce,Y.id),k(v,pe),((U=ce.children)==null?void 0:U.length)>=0&&H(ce)}}H(E),M(v,y)}function j(){const v=Math.max(...e.value);if(v===-1/0)return e.value.push(0),0;if(v>=0)return e.value.push(v+1),v+1}const M=function(v,y,C,_=!1){var L,k,F;const E=we();(L=E.focussedElements.find(H=>H.contextid==v))!=null&&L.elements.includes(y.id)&&((k=E.focussedElements.find(H=>H.contextid==v))==null||k.elements.splice(E.focussedElements.indexOf(y.id),1)),(F=t(v).value)==null||F.findIndex(H=>H.id==y.id)},B=function(v,y,C,_=!1){var L,k,F,H;const E=we();for(const Y of y){(L=E.focussedElements.find(U=>U.contextid==v))!=null&&L.elements.includes(Y.id)&&((k=E.focussedElements.find(U=>U.contextid==v))==null||k.elements.splice(E.focussedElements.indexOf(Y.id),1));const ie=(F=t(v).value)==null?void 0:F.findIndex(U=>U.id==Y.id);(H=i.value.find(U=>U.contextid==v))==null||H.webnodes.splice(ie,1)}},J=function(v,y,C,_=!1){for(const E of y)Q(v,E)},Q=function(v,y,C,_=!1){return y.id=j(),i.value.find(L=>L.contextid==v).webnodes.push(y),y},q=function(v,y,C,_=!1){typeof y=="number"?s(v,y).value:s(v,y.id).value;for(const E of C);return{success:!1,message:""}},he=function(v,y,C=void 0,_=!1){for(const E of y)q(v,E.elementid,E.values);return{success:!1,message:""}};function ne(v,y){if(Array.isArray(y)){for(const _ of y)if(C(_)==!1)return!1}else C(y);function C(_){if(_.type.includes("environment")||_.type.includes("env"))return!1}return!0}return{GetChildren:p,validateStateManagementRestrictions:ne,deleteElements:B,createElements:J,createElement:Q,updateElement:q,updateElements:he,webnodecontexts:i,registerednodeids:e,getContextWebNodesbyType:n,getChildren:g,getContext:r,getContextWebNodes:t,getTreeLevel:o,byId:s,byKey:f,addWebNodeContext:P,deleteWebNodeContext:D,changeNodeContext:T,createIdentifier:j,deleteElement:M}});class wt{constructor(e,t,n,r,o){this.name=e,this.type=t,this.guui=n,this.value=r,this.sessioncontextid=o}GetType(){return this.type}finalizeSolution(){var e;if(this.sessioncontextid!=null&&(this.value=JSON.parse(JSON.stringify(z().getContextWebNodes(this.sessioncontextid).value))),(e=this.type)!=null&&e.includes("diagram")){const t=this.value.findIndex(n=>n.type.includes("env"));t!=-1&&this.value.splice(t,1)}}getValue(){return this.value}}class qe{constructor(e){this.config=e,this.setup(e)}setup(e){this.instance=yt.create({baseURL:e.url,headers:e==null?void 0:e.headers,data:e.data})}Get(e,t,n){var r;return(r=this.instance)==null?void 0:r.get(e+t.url,t).then(o=>{n!=null&&n(o)}).catch(o=>o).finally(()=>{})}Post(e,t){var n;return(n=this.instance)==null?void 0:n.post(e,t.data,t)}Put(e,t){var n;return(n=this.instance)==null?void 0:n.put(e,t)}Delete(e,t){var n;return(n=this.instance)==null?void 0:n.delete(e,t)}createAxiosConfig(e){return{url:e.url,method:e.method,headers:e.headers}}sendRequest(e,t){const n=this.createAxiosConfig(e);switch(e.method){case"GET":return this.Get(this.config.url,n,t);case"POST":return this.Post(this.config.url+e.url,n);case"PUT":return this.Put(this.config.url,n);case"DELETE":return this.Delete(this.config.url,n)}}}var St=Object.defineProperty,At=Object.getOwnPropertyDescriptor,Ot=(i,e,t,n)=>{for(var r=n>1?void 0:n?At(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&St(e,t,r),r};a.HTTPClientService=class{constructor(){this.clients=Array(),this.networks=Array()}createClient(e){this.clients.push(new qe(e))}GetOrCreateClient(e){let t=this.clients.find(n=>n.config.name==e.networkname);if(t==null){const n=this.networks.find(r=>r.name==e.networkname);if(n==null)throw new Error("No network found with name: "+e.networkname);t=this.createClient(n),this.clients.push(t)}return t}async sendRequest(e){const n=await this.GetOrCreateClient(e).sendRequest(e);console.log(n)}Create(e,t){return this.GetOrCreateClient({networkname:t,method:"POST"}).sendRequest({url:"",method:"POST",data:e,networkname:t})}},a.HTTPClientService=Ot([O.injectable()],a.HTTPClientService);class Pt{}class ke{constructor(e,t){this.targetBOIC=new Array,this.id="transaction_"+e,this.nvc=new Ce,t&&t.forEach(n=>{this.nvc.add(n.key,n.value)})}}var We=(i=>(i.fillIn="fillIn",i.check="check",i.execute="execute",i))(We||{}),_t=Object.defineProperty,Et=Object.getOwnPropertyDescriptor,It=(i,e,t,n)=>{for(var r=n>1?void 0:n?Et(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&_t(e,t,r),r};a.TransactionService=class{constructor(){this.bindings=new Array}BeginTransaction(e){this.transaction=new ke(e);for(const t of Object.values(We))this.transaction.callMode=t,this.OnTransactionBegin();return this.transaction}OnTransactionBegin(){for(const e of this.bindings)e(this.transaction)}Commit(){}UpdateNVC(e){if(this.transaction!=null)for(const t of e)this.transaction.nvc.setValue(t.key,t.value)}BindOnTransactionBegin(e){this.bindings.push(e)}},a.TransactionService=It([O.injectable()],a.TransactionService);var xt=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,jt=(i,e,t,n)=>{for(var r=n>1?void 0:n?Tt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&xt(e,t,r),r};a.BaseServiceProvider=class{constructor(e){this.contextid=e}GetService(e,t){return this.container==null&&(t!=null?this.container=S.inject("iotcontainer_"+t,void 0):this.container=S.inject("iotcontainer_"+this.contextid,void 0)),this.container==null?a.BaseServiceProvider.GetContainer(t??this.contextid).get(e):this.container.get(e)}static Service(e){return S.inject("iotcontainer_0",void 0).get(e)}static ServiceWithContext(e,t){let n=S.inject("iotcontainer_"+t,void 0);return n==null&&(n=a.BaseServiceProvider.GetContainer(t)),n.get(e)}static GetContainer(e){let t=S.inject("iotcontainer_"+e,void 0);if(t==null){for(let n=e;n<=e;n--)if(t=S.inject("iotcontainer_"+n,void 0),t!=null)return t}return t}static ServiceWithAppContext(e,t){let n=S.inject("iotcontainer_"+t,void 0);if(n==null){for(let r=t;r<=t;r--)if(n=S.inject("iotcontainer_"+r,void 0),n!=null)return{service:n.get(e),contextid:r}}return{service:n.get(e),contextid:t}}},a.BaseServiceProvider=jt([O.injectable()],a.BaseServiceProvider);class Le extends a.BaseServiceProvider{constructor(e){var n;super((n=S.toValue(e))==null?void 0:n.contextid),this.config=e;const t=this.GetConfiguration();if(t.id==null)throw new Error("ViewConfiguration id is undefined");if(t.contextid==null)throw new Error("ViewConfiguration contextid is undefined")}GetConfiguration(){return S.toValue(this.config)}getTemplateRef(){return this.templateRef}}class de{static ValidateExpression(e){return e==null||e==""||e==null||typeof e!="string"?!1:e.match(/{{.*}}/)!=null}}function Mt(i,e,t){if(de.ValidateExpression(t)===!1)throw new Error("Invalid expression");const n=t.indexOf("{{"),r=t.lastIndexOf("}}");return t=t.substring(n+2,r).trim(),S.computed(()=>{const{components:s,variables:f}=i.GetContext(e),p=o(t,s,f);try{return new Function("components","variables","return "+p)(s,f)}catch{return p}});function o(s,f,p){var D,T;const g=new RegExp("(?<=variables\\.)[\\w-]+(?=(\\.|$|\\s))","g"),P=new RegExp("(?<=components\\.)[\\w-]+(?=(\\.|$|\\s))","g");return(D=s.match(g))==null||D.forEach(j=>{const M=p[j];let B;if(de.ValidateExpression(M)){const J=M.indexOf("{{"),Q=M.lastIndexOf("}}");B=M.substring(J+2,Q).trim(),B=new Function("variables","components","return "+B)(p,p),de.ValidateExpression(B)&&(B=o(B,f,p))}else B=M;s=s.replace("variables."+j,B)}),(T=s.match(P))==null||T.forEach(j=>{const M=s.indexOf(j)+j.length;let J=Function("components","variables","return components."+j)(f,p),Q="";for(let q=M;q<s.length;q++)if(s[q]==="."){const he=s.indexOf(".",q+1)!=-1?s.indexOf(".",q+1):s.indexOf(" ",q+1)!=-1?s.indexOf(" ",q+1):s.indexOf(")",q+1)!=-1?s.indexOf(")",q+1):s.length,ne=s.substring(q+1,he);J[ne]===void 0||(Q+="."+ne,J=J[ne])}s=s.replace("components."+j+Q,J)}),s}}function Ae(i,e,t){return de.ValidateExpression(t)==!0?Mt(i,e,t).value:t}class He extends Le{constructor(e){super(e),this.isRegisteredInGlobalScope=!1,this.actionFactory=this.GetService("UIActionFactory")}handleEvent(e,t){console.log("handle event",t,e),this.CreateAction(t.action).execute()}bind(){var n;const e=this.GetConfiguration();if(e==null)throw new Error("ViewElement configuration is undefined");if(e.interaction==null)return;const t=this.GetService("EventBus");if(e.interaction.events!=null)for(const r of(n=e.interaction)==null?void 0:n.events)t.on(r,this)}unbind(){console.log("unbind",this);const e=this.GetConfiguration();if(e==null)throw new Error("ViewElement configuration is undefined");if(e.interaction==null)return;const t=this.GetService("EventBus");for(const n of e.interaction.events)t.off(n,this)}RegisterMethodsInGlobalScope(e){const t=this.GetService("GlobalStateProvider");if(t==null)throw new Error("GlobalStateProvider service not found");t.AddViewContext({viewId:this.GetConfiguration().publicIdentifier,localActions:e}),this.isRegisteredInGlobalScope=!0}CreateAction(e){return this.actionFactory==null&&(this.actionFactory=this.GetService("UIActionFactory")),this.actionFactory.create(e)}GetActions(){return this.GetConfiguration().interaction.actions}ProvideContext(){return this.viewContextProvider==null&&(this.viewContextProvider=this.GetService("ExecutionContextProvider")),{contextProvider:this.viewContextProvider,contextid:this.GetConfiguration().contextid}}ResolveTemplateProperty(e){return this.viewContextProvider==null&&(this.viewContextProvider=this.GetService("ExecutionContextProvider")),Ae(this.viewContextProvider,this.GetConfiguration().contextid,e)}}var $=(i=>(i.create="create",i.update="update",i.delete="delete",i.updatePartial="updatePartial",i))($||{}),ge=(i=>(i.none="none",i.immediate="immediate",i.manual="manual",i))(ge||{}),Fe=(i=>(i.BODataAdapter="BODataAdapter",i.BORepository="BORepository",i))(Fe||{}),Dt=Object.defineProperty,Nt=Object.getOwnPropertyDescriptor,Bt=(i,e,t,n)=>{for(var r=n>1?void 0:n?Nt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Dt(e,t,r),r};a.DataAdapter=class{constructor(e,t,n){this.ownsIds=[],this.contextid=t,this.options=e;const r=n??a.BaseServiceProvider.GetContainer(e.contextId??t);if(r==null)throw new Error("No iot container found for appcontext: "+this.options.contextId);this.repository=r.get(Fe.BORepository),this.options.subscribe!=null&&this.Subscribe(),this.boService=r.get("BOService"),e.persistGlobalStorage==!0&&(this.httpService=r.get("HTTPClientService"))}Dispose(){this.Unsubscribe()}Unsubscribe(){this.repository.Unsubscribe(this)}SetStateChangeHandler(e){this.stateChangeHandler=e}HandleStateChange(e,t,n,r){this.stateChangeHandler!=null&&this.stateChangeHandler(e,t,n,r)}SetBeforeStateChangeHandler(e){this.beforeStateChangeHandler=e}HandleBeforeStateChange(e,t,n){this.beforeStateChangeHandler!=null&&this.beforeStateChangeHandler(e,t,n)}Subscribe(){this.repository.Subscribe(this)}Create(e,t){return e.id==null&&this.boService.NewId(e),t!=null?e.contextid=t:e.contextid==null&&e.contextid==null&&(e.contextid=this.options.contextId),this.SetBoType(e),this.options.persistGlobalStorage==!0&&this.httpService.sendRequest(e,this.options.contextId),this.ownsIds.push(e.id),this.repository.Create(e,this.options.persistLocalStorage,t)}Find(e,t){return this.repository.Get(e,t)[0]}Get(e){return this.repository.Get(this.options.boType.name,e,this.options.contextId)}Update(e,t,n,r){return this.SetBoType(t),this.repository.Update(e,t,this.options.persistLocalStorage,n,r)}Delete(e,t){return this.repository.Delete(e,this.options.persistLocalStorage,t)}UpdatePartial(e,t,n,r,o){return this.repository.UpdatePartial(e,t,this.options.persistLocalStorage,n,r,o)}SetBoType(e){var t;if(e.boName==null){if(((t=this.options.boType)==null?void 0:t.name)==null)throw new Error("No BO with id "+e.id+" cant be created because no BO Type is defined");e.boName=this.options.boType.name}}},a.DataAdapter=Bt([O.injectable()],a.DataAdapter);class Rt{constructor(e,t){this.syncStateMode=t,this.sessioncontextid=e;const n=new a.BaseServiceProvider().GetService("BOService",e);this.boService=n,this.CreateBOAdapter({boType:{name:"ViewConfiguration"},contextId:e},e)}Id(e){return this.boService.NewId(e)}CreateAndReturnBOAdapter(e,t){return new a.DataAdapter(e,t)}CreateBOAdapter(e,t){this.dataAdapter=new a.DataAdapter(e,t),console.log(this.dataAdapter)}PatchStateUpdate(e,t,n=!1){if(!(this.config==null||this.config.syncStateMode==null)&&(this.config.syncStateMode==ge.immediate||this.config.syncStateMode==ge.manual&&n==!0))switch(t){case $.create:this.dataAdapter.Create(e);break;case $.update:this.dataAdapter.Update(e.id,e);break;case $.delete:this.dataAdapter.Delete(e);break}}UseService(e){return this.container.get(e)}Subscribe(e){this.dataAdapter.SetStateChangeHandler(e)}PartialUpdate(e,t){this.dataAdapter.UpdatePartial(e.id,new Ce([t]),this.sessioncontextid)}Dispose(){var e;(e=this.dataAdapter)==null||e.Unsubscribe()}}class re{constructor(e){this.name=e.name,this.propertys=e.propertys}static UnkownBO(e){return new re({name:e})}}class Oe{constructor(){this.boTypes=[]}AddBOType(e){this.boTypes.push(e)}AddBOTypes(e){this.boTypes=e}CreateBOType(e,t){const n=new re;n.name=e,n.propertys=t,this.boTypes.push(n)}}const be=W.defineStore("app",{state:()=>({user:{},boDeclarations:new Oe,dataContexts:Array()}),getters:{},actions:{createDataContext(){if(this.dataContexts.length===0)return this.dataContexts.push(1),1;{const i=this.dataContexts[this.dataContexts.length-1]+1;return this.dataContexts.push(i),i}}}}),Vt=W.defineStore("webnodetemplates",{state:()=>({avaiblenodetemplates:S.markRaw([])}),getters:{getall(){return this.avaiblenodetemplates}},actions:{addTemplates(i){this.avaiblenodetemplates.push(...i)}}});class Ue{constructor(e){this.stateHistory=new Array,this.store=e,this.validateStore()==!0&&this.store.$onAction(t=>{t.name.startsWith("deleteElements")?this.validateActionRestriction(t.args)==!0&&this.saveDeletedStateChanges(t):t.name.startsWith("createElements")?this.validateActionRestriction(t.args)==!0&&this.saveCreatedStateChanges(t):t.name.startsWith("createElement")?this.validateActionRestriction(t.args)==!0&&this.saveCreatedStateChange(t):t.name=="updateElements"?this.validateActionRestriction(t.args)==!0&&this.saveUpdatedStateChanges(t):t.name.startsWith("updateElement")?this.validateActionRestriction(t.args)==!0&&this.saveUpdatedStateChange(t):t.name.startsWith("deleteElement")&&this.validateActionRestriction(t.args)==!0&&this.saveDeletedStateChange(t)})}simulateUpdateOneAction(e,t,n){const r=this.stateHistory.find(o=>o.contextid==e);if(r!=null){const o={calledActionName:"updateElement",calledActionInput:this.getUpdateOneAcionCalledInput(e,t,n),reverseActionName:"updateElement",reverseActionInput:[e,t,n,!0]};r.stateChanges.splice(r.currentTrackingStateIndex,0,o),r.currentTrackingStateIndex+=1}}validateStore(){return!(this.store.createElement==null||this.store.deleteElement==null||this.store.updateElement==null||this.store.updateElements==null||this.store.deleteElements==null)}isUndoAble(e){return e.currentTrackingStateIndex>0}isRedoAble(e){if(e.currentTrackingStateIndex<e.stateChanges.length)return!0}undo(e){const t=this.stateHistory.find(n=>n.contextid==e);if(t!=null&&this.isUndoAble(t)==!0){if((t==null?void 0:t.currentTrackingStateIndex)<0)return;const n=t==null?void 0:t.stateChanges[t.currentTrackingStateIndex-1];this.validateManagerActionRestriction(n.calledActionInput)==!0&&(this.callReverseAction(n),t.currentTrackingStateIndex-=1);return}}redo(e){const t=this.stateHistory.find(n=>n.contextid==e);if(t!=null&&this.isRedoAble(t)==!0){if((t==null?void 0:t.currentTrackingStateIndex)>=t.stateChanges.length)return;const n=t==null?void 0:t.stateChanges[t.currentTrackingStateIndex];this.callAction(n),t.currentTrackingStateIndex+=1,console.log(n,t.currentTrackingStateIndex,t==null?void 0:t.stateChanges);return}}validateManagerActionRestriction(e){return this.store.validateStateManagementRestrictions!=null?this.store.validateStateManagementRestrictions(e[0],e[1]):!1}validateActionRestriction(e){return this.store.validateStateManagementRestrictions!=null&&e[3]==!0?this.store.validateStateManagementRestrictions(e[0],e[1]):!1}callAction(e){e.calledActionName=="updateElements"?this.callUpdateMobjectAction(e.calledActionInput):e.calledActionName=="updateElement"?this.callUpdateAction(e.calledActionInput):e.calledActionName=="createElement"?this.callCreateAction(e.calledActionInput):e.calledActionName=="deleteElement"?this.callDeleteAction(e.calledActionInput):e.calledActionName=="deleteElements"&&this.callDeleteMobjectAction(e.calledActionInput)}callReverseAction(e){e.reverseActionName=="updateElements"?this.callUpdateMobjectAction(e.reverseActionInput):e.reverseActionName=="updateElement"?this.callUpdateAction(e.reverseActionInput):e.reverseActionName=="createElement"?this.callCreateAction(e.reverseActionInput):e.reverseActionName=="deleteElement"?this.callDeleteAction(e.reverseActionInput):e.reverseActionName=="deleteElements"?this.callDeleteMobjectAction(e.reverseActionInput):e.reverseActionName=="createElements"&&this.callCreateMobjectAction(e.reverseActionInput)}callUpdateAction(e){this.store.updateElement(e[0],e[1],e[2],!1)}callCreateAction(e){this.store.createElement(e[0],e[1],e[2],!1)}callCreateMobjectAction(e){this.store.createElements(e[0],e[1],void 0,!1)}callUpdateMobjectAction(e){this.store.updateElements(e[0],e[1],void 0,!1)}callDeleteAction(e){this.store.deleteElement(e[0],e[1],e[2],!1)}callDeleteMobjectAction(e){this.store.deleteElements(e[0],e[1],void 0,!1)}registerContextStateIfNotExists(e){this.stateHistory.find(t=>t.contextid==e)==null&&this.stateHistory.push({contextid:e,stateChanges:new Array,currentTrackingStateIndex:0})}saveCreatedStateChanges(e){if(e.name!="createElements")throw new Error('saveCreatedStateChange: name your create action "createElements"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){if(this.store.deleteElements==null)throw new Error('saveCreatedStateChange: name your delete action "deleteElements", otherwise your statechanges triggerd by "createElement" will not be reversible');const n={calledActionName:e.name,reverseActionName:"deleteElement",calledActionInput:e.args,reverseActionInput:e.args};n.calledActionInput[3]=!1,n.reverseActionInput[3]=!1,console.log(n),t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}saveCreatedStateChange(e){if(e.name!="createElement")throw new Error('saveCreatedStateChange: name your create action "createElement"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){if(this.store.deleteElement==null)throw new Error('saveCreatedStateChange: name your delete action "deleteElement", otherwise your statechanges triggerd by "createElement" will not be reversible');const n={calledActionName:e.name,reverseActionName:"deleteElement",calledActionInput:e.args,reverseActionInput:e.args};n.calledActionInput[3]=!1,n.reverseActionInput[3]=!1,t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}saveDeletedStateChanges(e){if(e.name!="deleteElements")throw new Error('saveDeletedStateChange: name your delete action "deleteElement"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){const n={calledActionName:e.name,reverseActionName:"createElements",calledActionInput:e.args,reverseActionInput:e.args};n.calledActionInput[3]=!1,n.reverseActionInput[3]=!1,t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}saveDeletedStateChange(e){if(e.name!="deleteElement")throw new Error('saveDeletedStateChange: name your delete action "deleteElement"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){const n={calledActionName:e.name,reverseActionName:"createElement",calledActionInput:e.args,reverseActionInput:e.args};n.calledActionInput[3]=!1,n.reverseActionInput[3]=!1,t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}saveUpdatedStateChange(e){if(e.name!="updateElement")throw new Error('saveUpdatedStateChange: name your update action "updateElement"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){const n={calledActionName:e.name,reverseActionName:e.name,calledActionInput:e.args,reverseActionInput:this.getUpdateOneAcionReverseInput(e)};t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}saveUpdatedStateChanges(e){if(e.name!="updateElements")throw new Error('saveUpdatedStateChange: name your update action "updateElements"');let t=this.stateHistory.find(n=>n.contextid==e.args[0]);if(this.registerContextStateIfNotExists(e.args[0]),t==null&&(t=this.stateHistory.find(n=>n.contextid==e.args[0])),t!=null){const n={calledActionName:e.name,reverseActionName:e.name,calledActionInput:e.args,reverseActionInput:this.getUpdateMobjectAcionReverseInput(e)};t.stateChanges.splice(t.currentTrackingStateIndex,0,n),t.currentTrackingStateIndex+=1}}getUpdateOneAcionCalledInput(e,t,n){const r=this.store.byId(e,t.id),o=[e,r.value,Array(),!0];for(const s of n)o[2].push({key:s.key,value:ve.get(r.value,s.key)});return o}getUpdateOneAcionReverseInput(e){const t=this.store.byId(e.args[0],e.args[1]),n=[e.args[0],t.id,Array(),!0];for(const r of e.args[2])n[2].push({key:r.key,value:ve.get(t.value,r.key)});return n}getUpdateMobjectAcionReverseInput(e){const t=this.store.byId(e.args[0],e.args[1]),n=[e.args[0],t.id,Array(),!1];for(const r of e.args[2]){const o={elementid:r.elementid,value:Array()};for(const s of r.value)o.value.push({key:s.key,value:ve.get(t,s.key)});n[2].push(o)}return n}}function Gt(i){if(i.store.$id.includes("webnodecontext"))return{stateManager:new Ue(i.store)}}var ze=(i=>(i.click="click",i.change="change",i.focus="focus",i.blur="blur",i.submit="submit",i.reset="reset",i.select="select",i.keydown="keydown",i.keypress="keypress",i.keyup="keyup",i.load="load",i.unload="unload",i.abort="abort",i.error="error",i.resize="resize",i.scroll="scroll",i.ctextmenu="ctextmenu",i.dblclick="dblclick",i.mousedown="mousedown",i.mousemove="mousemove",i.mouseout="mouseout",i.mouseover="mouseover",i.mouseup="mouseup",i.mousewheel="mousewheel",i.wheel="wheel",i.copy="copy",i.cut="cut",i.paste="paste",i.drag="drag",i.dragend="dragend",i.dragenter="dragenter",i.dragleave="dragleave",i.dragover="dragover",i.dragstart="dragstart",i.drop="drop",i.input="input",i.invalid="invalid",i.search="search",i.animatiend="animatiend",i.animatiiterati="animatiiterati",i.animatistart="animatistart",i.transitiend="transitiend",i))(ze||{}),ye=(i=>(i["dom Event"]="dom Event",i["custom Event"]="custom Event",i))(ye||{}),ee=(i=>(i.SetValueAction="SetValueAction",i.SetValuesAction="SetValuesAction",i.SendRequestAction="SendRequestAction",i.CallLocalMethodAction="CallLocalMethodAction",i))(ee||{}),$t=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,kt=(i,e,t,n)=>{for(var r=n>1?void 0:n?qt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&$t(e,t,r),r};a.UIAction=class{constructor(e){this.config=e}execute(){}},a.UIAction=kt([O.injectable()],a.UIAction);var Je=(i=>(i.viewModel="viewModel",i.view="view",i.model="model",i.globalVariable="globalVariable",i))(Je||{}),Wt=Object.defineProperty,Lt=Object.getOwnPropertyDescriptor,oe=(i,e,t,n)=>{for(var r=n>1?void 0:n?Lt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Wt(e,t,r),r},Qe=(i,e)=>(t,n)=>e(t,n,i);a.UIActionFactory=class{constructor(e,t){this.globalStateProvider=t,this.httpService=e,this.globalStateProvider=t}create(e){switch(e.type){case ee.SendRequestAction:return new this.sendRequestAction(this.httpService,view,e);case ee.SetValueAction:return new this.setValueAction(view,e);case ee.SetValuesAction:return new this.setValuesAction(view,e);case ee.CallLocalMethodAction:return(t,n)=>new this.callLocalMethodAction(t,n);case ee.ControlComponentAction:return new this.controlComponentAction(this.globalStateProvider,e)}}},oe([O.inject("SendRequestActionConstructor")],a.UIActionFactory.prototype,"sendRequestAction",2),oe([O.inject("SetValueActionConstructor")],a.UIActionFactory.prototype,"setValueAction",2),oe([O.inject("SetValuesActionConstructor")],a.UIActionFactory.prototype,"setValuesAction",2),oe([O.inject("CallLocalMethodActionConstructor")],a.UIActionFactory.prototype,"callLocalMethodAction",2),oe([O.inject("ControlComponentActionConstructor")],a.UIActionFactory.prototype,"controlComponentAction",2),a.UIActionFactory=oe([O.injectable(),Qe(0,O.inject("HTTPClientService")),Qe(1,O.inject("GlobalStateProvider"))],a.UIActionFactory);var Ye=(i=>(i["Control component"]="Control component",i["Trigger event"]="Trigger event",i["Run script"]="Run script",i["Set local variable"]="Set local variable",i["Start client workflow"]="Start client workflow",i["Queue process"]="Queue process",i["Go to url"]="Go to url",i))(Ye||{}),Ze=(i=>(i.viewModel="viewModel",i.view="view",i.model="model",i.globalVariable="globalVariable",i))(Ze||{}),Xe=(i=>(i.GET="GET",i.POST="POST",i.PUT="PUT",i.DELETE="DELETE",i.PATCH="PATCH",i))(Xe||{}),Ht=Object.defineProperty,Ft=Object.getOwnPropertyDescriptor,Ut=(i,e,t,n)=>{for(var r=n>1?void 0:n?Ft(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Ht(e,t,r),r};a.SetValueAction=class extends a.UIAction{constructor(e){super(),console.log(e)}execute(){}},a.SetValueAction=Ut([O.injectable()],a.SetValueAction);class Ke extends a.UIAction{constructor(e){super(),this.options=definition.options,console.log(e)}execute(){}}var zt=Object.defineProperty,Jt=Object.getOwnPropertyDescriptor,Qt=(i,e,t,n)=>{for(var r=n>1?void 0:n?Jt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&zt(e,t,r),r};a.SendRequestAction=class extends a.UIAction{constructor(e,t){super(e,t);const n=S.inject("iotcontainer");this.service=n.get("HTTPClientService"),this.options=e}execute(e){this.options.request.data=e.nvc.toObject(),this.service.sendRequest(this.options.request)}},a.SendRequestAction=Qt([O.injectable()],a.SendRequestAction);function et(i,e,t){let n={};for(let r in i)n[r]=i[r];for(let r in e)Array.isArray(e[r])?n[r]=e[r]:typeof e[r]=="object"&&e[r]!==null?n[r]=et(i[r]||{},e[r]):i[r]===void 0?n[r]=e[r]:n[r]=i[r];return n}function Pe(i){return new Promise(e=>{if(document.querySelector(i))return e(document.querySelector(i));const t=new MutationObserver(n=>{if(document.querySelector(i))return e(document.querySelector(i)),t.disconnect(),n});t.observe(document.body,{childList:!0,subtree:!0})})}var Yt=Object.defineProperty,Zt=Object.getOwnPropertyDescriptor,Xt=(i,e,t,n)=>{for(var r=n>1?void 0:n?Zt(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Yt(e,t,r),r};a.TabService=class{constructor(){this.tabs=S.ref([])}AddAndOpenTab(e){this.AddTab(e),this.OpenTab(e)}AddTab(e){this.tabs.value.push(e)}OpenTab(e){this.navigationHandler(e)}GetTabs(){return S.computed(()=>this.tabs.value)}SetNavigationHandler(e){this.navigationHandler=e}},a.TabService=Xt([O.injectable()],a.TabService);function Kt(){function i(e){const t=z(W.getActivePinia()).addWebNodeContext("environment");return e.sessioncontextid=t,me().addCreation(e),t}return{create:i}}class en{}class tn{}class tt{constructor(e,t){this.controller=e,this.component=t}initialize(e,t){if(this.controller!=null||t==null){const n=z().addWebNodeContext(this.viewidentifier);e.viewcontextid=n,this.contextid=n}else this.contextid=t,e.viewcontextid=this.contextid;return(e==null?void 0:e.id)==null?this.viewidentifier=S.toValue(z().createElement(this.contextid,e)).id:this.viewidentifier=e.id,this.contextid}dispose(){z().deleteElement(this.contextid,this.viewidentifier),this.contextid&&z().deleteWebNodeContext(this.contextid)}render(){const e=this.dispose;return this.controller?S.h(this.controller,{contextid:this.contextid,viewIdentifier:this.viewidentifier,dispose:e}):S.h(this.component,{contextid:this.contextid,viewidentifier:this.viewidentifier,dispose:e})}}var fe=(i=>(i.standalone="standalone",i.extension="extension",i.shadow="shadow",i))(fe||{});const _e=W.defineStore("data",()=>{var s;const i=S.ref(new Array),e=(s=be(W.getActivePinia()).boDeclarations)==null?void 0:s.boTypes;function t(f){let p=1;i.value.length>0&&(p=i.value.map(g=>g.id).reduce((g,P)=>g>P?g:P)+1),f.id=p,i.value.push(f)}function n(f,p){var g;return(g=i.value.find(P=>P.contextid===p&&P.boType.name==f))==null?void 0:g.value}function r(f,p,g,P){var j;const T=((j=i.value.find(M=>M.contextid===p&&M.boType.name==f))==null?void 0:j.value).find(M=>M[g]===P);return T==null?[]:Object.entries(T)}function o(f,p,g,P){var D;return(D=i.value.find(T=>T.contextid===p&&T.boType.name==f))==null?void 0:D.value.find(T=>T[g]===P)}return{containers:i,boTypes:e,AddContainer:t,GetBosByContext:n,GetBoInstancePropertysByField:r,FindByField:o}});class nn{constructor(e,t){this.value=t,this.boType=e}GetValueType(){return typeof this.value}}var rn=Object.defineProperty,on=Object.getOwnPropertyDescriptor,sn=(i,e,t,n)=>{for(var r=n>1?void 0:n?on(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&rn(e,t,r),r},nt=(i,e)=>(t,n)=>e(t,n,i);a.BORepository=class{constructor(e,t){this.subscribers=[],this.BOIds=[],this.contextManager=e,this.pinia=t,this.store=_e(t)}Create(e,t=!1,n=null){var r;if(this.Publish(e.id,e,$.create,n,void 0,void 0,!0),n==null){const o=this.contextManager.NewContext();e.contextid=o.contextid}if(t==!0){let o=(r=this.store.containers.find(s=>{var f;return((f=s.boType)==null?void 0:f.name)==e.boName}))==null?void 0:r.id;o==null&&(o=this.CreateContainer(e,n)),this.store.$patch(s=>{s.containers.find(f=>f.id==o).value.push(e)})}return this.Publish(e.id,e,$.create,n,void 0,void 0,!1),e}Get(e,t,n=null){let r;return n==null?r=this.store.containers.find(o=>o.boType.name==e):r=this.store.containers.find(o=>o.boType.name==e&&o.contextid==n),r==null?[]:t==null?r.value:r.value.filter(t)}Update(e,t,n=!1,r=null,o){var s,f;if(n==!1&&this.Publish(e,t,$.update,r,void 0,o,!0),n==!0){const p=(f=(s=this.store.containers.find(g=>g.boType.name==t.boName))==null?void 0:s.value)==null?void 0:f.findIndex(g=>g.id==e);if(p==null)throw new Error("No BO with id "+e+" found");o==null&&(o=this.store.$state.containers.find(g=>g.boType.name==t.boName).value[p]),this.Publish(e,t,$.update,r,void 0,o,!0),this.store.$patch(g=>{g.containers.find(P=>P.boType.name==t.boName).value[p]=t})}return this.Publish(e,t,$.update,r,void 0,o,!1),t}Delete(e,t=!1,n=null){if(this.Publish(e.id,e,$.delete,n,void 0,void 0,!0),t==!0){const r=this.store.containers.findIndex(o=>o.value.findIndex(s=>s.id==e.id)!=-1);if(r==-1)throw new Error("No BO with id "+e.id+" found");this.store.$patch(o=>{o.containers[r].value.splice(o.containers[r].value.findIndex(s=>s.id==e.id),1)})}this.Publish(e.id,e,$.delete,n,void 0,void 0,!1)}UpdatePartial(e,t,n=!1,r=null,o,s){if(n==!1&&this.Publish(e,t,$.updatePartial,r,o,s,!0),n==!0){const f=this.store.containers.findIndex(g=>g.value.findIndex(P=>P.id==e)!=-1),p=this.store.containers[f].value.find(g=>g.id==e);if(f==-1)throw new Error("No BO with id "+e+" found");s==null&&(s=this.store.$state.containers.find(g=>g.boType.name==p.boName).value[f]),this.Publish(e,t,$.updatePartial,r,o,s,!0),this.store.$patch(()=>{for(const g of t.keyValuePairs)ve.set(p,g.key,g.value)})}this.Publish(e,t,$.updatePartial,r,o,s,!1)}async Publish(e,t,n,r=null,o,s,f=!1){for(const p of this.subscribers)r==null?(t.boName==p.options.boType.name||o==p.options.boType.name)&&!this.AdapterIsBOOwner(p,t)&&this.NotifySubscriber(p,e,t,n,s,f):r==p.contextid&&(t.boName==p.options.boType.name||t.boName==null)&&!this.AdapterIsBOOwner(p,t)&&this.NotifySubscriber(p,e,t,n,s,f)}AdapterIsBOOwner(e,t){return!!e.ownsIds.includes(t.id)}async NotifySubscriber(e,t,n,r,o,s){if(s==!0){e==null||e.HandleBeforeStateChange(t,n,r,o);return}else e==null||e.HandleStateChange(t,n,r,o)}Subscribe(e){e.id=this.subscribers.length+1,this.subscribers.push(e)}Unsubscribe(e){this.subscribers=this.subscribers.filter(t=>t.id==e.id)}CreateContainer(e,t){let n;e.boType==null&&e.boName!=null?n=new re({name:e.boName,propertys:[]}):e.boType!=null&&(n=e.boType);const r=new nn(n,[]);return r.contextid=t,this.store.AddContainer(r),r.id}},a.BORepository=sn([O.injectable(),nt(0,O.inject("DataContextManager")),nt(1,O.inject("Pinia"))],a.BORepository);var an=Object.defineProperty,cn=Object.getOwnPropertyDescriptor,ln=(i,e,t,n)=>{for(var r=n>1?void 0:n?cn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&an(e,t,r),r};a.BOService=class{constructor(){this.boIds=[]}NewId(e){const t=this.boIds.length>0?Math.max(...this.boIds)+1:1;return this.boIds.push(t),e.id=t,e}},a.BOService=ln([O.injectable()],a.BOService);var un=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,fn=(i,e,t,n)=>{for(var r=n>1?void 0:n?dn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&un(e,t,r),r};a.Screen=class{constructor(){this.quasarPlatformDetect=Me.Platform,this.subscribers=[],this.screenWidth=document.documentElement.clientWidth,this.screenHeight=document.documentElement.clientHeight,(!this.screenWidth||!this.screenHeight)&&this.SetScreenSize(),window.addEventListener("resize",()=>{this.SetScreenSize()})}ChangeScreenSize(e,t){console.log(t,e),this.screenWidth=e,this.screenHeight=t,this.NotifyScreenChanged()}GetScreenSize(){return{screenWidth:this.screenWidth,screenHeight:this.screenHeight}}Subscribe(e){this.subscribers.push(e)}NotifyScreenChanged(){this.subscribers.forEach(e=>{e(this.screenWidth,this.screenHeight)})}SetScreenSize(){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight,this.NotifyScreenChanged()}},a.Screen=fn([O.injectable()],a.Screen);var X=(i=>(i[i.Application=0]="Application",i[i.State=1]="State",i))(X||{}),hn=Object.defineProperty,pn=Object.getOwnPropertyDescriptor,vn=(i,e,t,n)=>{for(var r=n>1?void 0:n?pn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&hn(e,t,r),r};a.DataContextManager=class{constructor(){this.Ids=[],this.hasParentManager=!1}UpgradeContextLevel(e,t,n){const r=n.findContextById(e);if(r==null)throw new Error("No context found with id: "+e);return r.contextLevel=t,this.rootContext=r,this.parentManager=n,r}NewContext(e,t){const n=this.hasParentManager==!0?this.parentManager.AddChildManagerContext()+1:this.Ids.length==0?0:this.Ids[this.Ids.length-1]+1,r=this.findContextById(e),o={contextid:n,parentId:r!=null?r.contextid:0,children:[],contextLevel:t??X.State};return this.Ids.push(n),r!=null?r.children.push(o):this.rootContext==null?this.rootContext=o:this.rootContext.children.push(o),o}GetParentContext(e){return this.findContextById(e.parentId)}getApplicationContext(e){const t=this.findContextById(e);return t.contextLevel!=null&&t.contextLevel==X.Application||t.parentId==null&&t.contextLevel==X.Application?t:t.parentId==null&&t.contextLevel!=X.Application?void 0:this.getApplicationContext(t.parentId)}findContextById(e){if(e!=null&&this.rootContext!=null)return this.traverseTree(this.rootContext,e)}traverseTree(e,t){if(e.contextid===t)return e;for(const n of e.children){const r=this.traverseTree(n,t);if(r)return r}return null}findClosestContextById(e){let t=null,n=1/0;return this.traverseTreeC(this.rootContext,e,r=>{if(r.contextLevel!=null&&r.contextLevel===0){const o=Math.abs(r.contextid-e);o<n&&(n=o,t=r)}}),t}traverseTreeC(e,t,n){n(e),e.children.sort((r,o)=>r.contextid-o.contextid);for(const r of e.children)this.traverseTreeC(r,t,n)}AddChildManagerContext(){const e=Math.max(...this.Ids)+1;return this.Ids.push(e),e}},a.DataContextManager=vn([O.injectable()],a.DataContextManager);class mn{constructor(){this.adapters=[]}AddAdapter(e){this.adapters.push(e)}GetBOData(e){console.log(e)}}var gn=Object.defineProperty,bn=Object.getOwnPropertyDescriptor,yn=(i,e,t,n)=>{for(var r=n>1?void 0:n?bn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&gn(e,t,r),r};a.ApplicationFactory=class{Create(e,t,n,r,o){return new st(e,t,n,r,o)}},a.ApplicationFactory=yn([O.injectable()],a.ApplicationFactory);var Cn=Object.defineProperty,wn=Object.getOwnPropertyDescriptor,Sn=(i,e,t,n)=>{for(var r=n>1?void 0:n?wn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Cn(e,t,r),r};a.EventBus=class{constructor(){this.events=new Array}on(e,t,n){const r=this.events.find(s=>s.event.id===e.id);console.log("register",e,r);let o;r==null&&(o={event:e,handler:t,args:n},this.events.push(o)),e.type==ye["dom Event"]&&o!=null&&this.RegisterDOMEvent(o,n)}off(e){const t=this.events.find(n=>n.event.id===e.id);console.log("unregister",e,t),t!=null&&(e.type==ye["dom Event"]&&this.DeleteDOMEvent(t),this.events.splice(this.events.indexOf(t),1))}emit(e,t,n){const r=this.events.find(o=>o.event===t);if(r)r.handler.handleEvent(e,t,n);else throw new Error("Event not registered")}RegisterDOMEvent(e,t){console.log("register dom element",e),Pe(`[data-element='element_${e.event.targetElementId}']`).then(n=>{console.log("element found",e);const r=new AbortController;n.addEventListener(e.event.identifier,o=>{this.emit(o,e.event,t)},{signal:r.signal}),e.abortController=r})}DeleteDOMEvent(e){e.abortController!=null&&e.abortController.abort()}},a.EventBus=Sn([O.injectable()],a.EventBus);var An=Object.defineProperty,On=Object.getOwnPropertyDescriptor,Pn=(i,e,t,n)=>{for(var r=n>1?void 0:n?On(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&An(e,t,r),r};a.GlobalStateProvider=class{constructor(){this.viewContexts=[]}AddViewContext(e){this.viewContexts.push(e)}RemoveViewContext(e){const t=this.viewContexts.findIndex(n=>n.viewId==e);t>=0&&this.viewContexts.splice(t,1)}},a.GlobalStateProvider=Pn([O.injectable()],a.GlobalStateProvider);var _n=Object.defineProperty,En=Object.getOwnPropertyDescriptor,In=(i,e,t,n)=>{for(var r=n>1?void 0:n?En(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&_n(e,t,r),r};a.ControlComponentAction=class extends a.UIAction{constructor(e,t){super(t),this.stateProvider=e}execute(){var n;const e=this.stateProvider.viewContexts.find(r=>r.viewId==this.config.component);if(e==null)throw new Error(`Component ${this.config.component} not found`);const t=(n=e.localActions)==null?void 0:n.find(r=>r.methodName==this.config.methodName);if(t==null)throw new Error(`Method ${this.config.methodName} not found`);t.function()}},a.ControlComponentAction=In([O.injectable()],a.ControlComponentAction);var xn=Object.defineProperty,Tn=Object.getOwnPropertyDescriptor,jn=(i,e,t,n)=>{for(var r=n>1?void 0:n?Tn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&xn(e,t,r),r};a.CallLocalMethodAction=class extends a.UIAction{constructor(e){super(e)}execute(e,t){if(typeof e[this.config.methodName]=="function")e[this.config.methodName](t);else throw new Error(`Method ${this.config.methodName} does not exist on ${e.constructor.name}`)}},a.CallLocalMethodAction=jn([O.injectable()],a.CallLocalMethodAction);var Mn=Object.defineProperty,Dn=Object.getOwnPropertyDescriptor,Nn=(i,e,t,n)=>{for(var r=n>1?void 0:n?Dn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Mn(e,t,r),r},it=(i,e)=>(t,n)=>e(t,n,i);let Ee=class{constructor(i,e){this.store=be(e),this.service=i}async Login(i,e){return(await this.service.sendRequest({url:this.store.apiBase+"/connect/token",method:"POST",data:new FormData({grant_type:"password",username:i,password:e})})).data}};Ee=Nn([O.injectable(),it(0,O.inject("HTTPClientService")),it(1,O.inject("Pinia"))],Ee);var Bn=Object.defineProperty,Rn=Object.getOwnPropertyDescriptor,Vn=(i,e,t,n)=>{for(var r=n>1?void 0:n?Rn(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&Bn(e,t,r),r},rt=(i,e)=>(t,n)=>e(t,n,i);a.CodeContextProvider=class{constructor(e,t){this.contextManager=e,this.store=_e(t)}GetContext(e){var o,s;if(e==null)throw new Error("contextid is undefined");const t={},n=this.contextManager.findClosestContextById(e);this.store.GetBosByContext("ViewConfiguration",e).forEach(f=>{t[f.publicidentifier]=f});const r={};return(s=(o=this.store.GetBosByContext("GlobalVariable",n.contextid)[0])==null?void 0:o.keyValuePairs)==null||s.forEach(f=>r[f.key]=f.value),{components:t,variables:r}}},a.CodeContextProvider=Vn([O.injectable(),rt(0,O.inject("DataContextManager")),rt(1,O.inject("Pinia"))],a.CodeContextProvider);class ot{InitializeServices(e,t,n){var r;if(e.bind("ApplicationConfiguration").toConstantValue(t),e.bind("TransactionService").to(a.TransactionService).inSingletonScope(),e.bind("DataAdapter").toConstructor(a.DataAdapter),e.bind("DataAdapterConstructor").toConstructor(a.DataAdapter),e.bind("DataFederation").toConstructor(mn),e.bind("DataContextManager").to(a.DataContextManager).inSingletonScope(),e.bind("Pinia").toConstantValue(n),e.bind("BORepository").to(a.BORepository).inSingletonScope(),t.mode==fe.shadow){const o=(r=S.inject("iotcontainer_0",void 0))==null?void 0:r.get("BOService");e.bind("BOService").toConstantValue(o)}else e.bind("BOService").to(a.BOService).inSingletonScope();e.bind("Screen").to(a.Screen).inSingletonScope(),e.bind("ApplicationFactory").to(a.ApplicationFactory).inSingletonScope(),e.bind("TabService").to(a.TabService).inSingletonScope(),e.bind("EventBus").to(a.EventBus).inSingletonScope(),e.bind("GlobalStateProvider").to(a.GlobalStateProvider).inSingletonScope(),e.bind("UIActionFactory").to(a.UIActionFactory).inSingletonScope(),e.bind("HTTPClientService").to(a.HTTPClientService).inSingletonScope(),e.bind("SendRequestActionConstructor").toConstructor(a.SendRequestAction),e.bind("SetValueActionConstructor").toConstructor(a.SetValueAction),e.bind("SetValuesActionConstructor").toConstructor(Ke),e.bind("ControlComponentActionConstructor").toConstructor(a.ControlComponentAction),e.bind("CallLocalMethodActionConstructor").toConstructor(a.CallLocalMethodAction),e.bind("AuthenticationService").to(Ee).inSingletonScope(),e.bind("ExecutionContextProvider").to(a.CodeContextProvider).inSingletonScope()}}class st{constructor(e,t,n,r,o,s){this.startups=[],this.networkConfigs=[],this.config=e,this.factory=t,this.settings=o,this.pinia=s,n!=null&&(this.rootApp=n),r!=null&&(this.vueRouter=r)}RegisterModule(e){if(e.components!=null&&e.components!=null&&e.components.length>0)for(const t of e.components)this.AddComponent(t);if(e.middleware!=null&&e.middleware!=null&&e.middleware.length>0)for(const t of e.middleware)this.AddMiddleware(t);if(typeof e.InitializeServices=="function"&&e.InitializeServices(this.container),typeof e.register=="function"&&(console.log(444,this.pinia),e.register(this,this.pinia)),e.networkConfigs!=null&&e.networkConfigs!=null&&e.networkConfigs.length>0)for(const t of e.networkConfigs)this.networkConfigs.push(t)}AddComponent(e){var t;if(e.component=this.factory.create(e),this.AddRoute(e),e.children!=null||e.children!=null||((t=e.children)==null?void 0:t.length)>0)for(const n of e.children)this.AddComponent(n)}AddMiddleware(e){e.register(this.vueRouter)}AddBODeclarations(e){this.boDeclarations=e;const t=new Oe;return t.AddBOTypes(e),be(this.pinia).boDeclarations=t,this}CreateDIContainer(){let e;if(this.config.mode==fe.shadow&&(e=S.inject("iotcontainer_0")),e!=null)return this.container=e.createChild(),this;this.container=new O.Container,this.container.bind("ApplicationComponentFactory").toConstantValue(this.factory);const t=new Oe;return t.AddBOTypes(this.boDeclarations),this.container.bind("BODeclarationContainer").toConstantValue(t),this.container.bind("ApplicationSettings").toConstantValue(this.settings),this}setup(){if(this.CreateDIContainer(),new ot().InitializeServices(this.container,this.config),this.config.mode==fe.standalone&&this.setupStandalone(),this.config.middleware!=null&&this.config.middleware!=null&&this.config.middleware.length>0)for(const t of this.config.middleware)this.AddMiddleware(t);if(this.config.modules!=null&&this.config.modules!=null&&this.config.modules.length>0)for(const t of this.config.modules)this.RegisterModule(t);return this}useStartup(e){return this.startups.push(e),this}SetupRoutes(){var e;if(this.config.standalone==!0){const t={history:this.CreateVueWebHistory()},n=[];this.config.components!=null&&this.config.components!=null&&this.config.components.length>0&&this.config.components.forEach(r=>{n.push(this.CreateRoute(r))}),t.routes=n,this.vueRouter=je.createRouter(t),(e=this.rootApp)==null||e.use(this.vueRouter)}}CreateVueWebHistory(){return je.createWebHistory()}AddRoute(e){var t,n,r,o,s;((t=e.route)==null?void 0:t.parent)!=null?this.vueRouter.addRoute(e.route.parent,{path:(n=e.route)==null?void 0:n.path,name:(r=e.route)==null?void 0:r.name,component:e.component.render()}):this.vueRouter.addRoute({path:(o=e.route)==null?void 0:o.path,name:(s=e.route)==null?void 0:s.name,component:e.component.render()})}CreateRoute(e){var t;return{path:e.route.path,component:e.component.render(),name:e.route.name,children:(t=e.children)==null?void 0:t.map(n=>this.CreateRoute(n))}}mount(){this.config.selector!=null&&Pe(this.config.selector).then(()=>{var e;(e=this.rootApp)==null||e.mount(this.config.selector)})}createComponent(e,t=void 0){const n=this.factory.create(e);return n.initialize(e,t),n}setupStandalone(){const e=this.createComponent(this.config.rootComponent),t=S.defineComponent({name:"TestComponent",props:{rootComponent:{type:tt,required:!0}},setup(r){return()=>r.rootComponent.render()}}),n=S.createApp(t,{rootComponent:e});Me.Quasar.install(n,{}),n.use(this.vueRouter),this.rootApp=n}build(){var o,s;const e=this.container.get("DataContextManager");if(e==null)throw new Error("DataContextManager not found");const t=(s=(o=this.container)==null?void 0:o.parent)==null?void 0:s.get("DataContextManager");let n;this.config.mode=="shadow"?(n=e.UpgradeContextLevel(this.config.contextid,X.Application,t).contextid,e.hasParentManager=!0):n=e.NewContext(void 0,X.Application).contextid,this.rootApp.provide("iotcontainer_"+n,this.container);const r=this.container.get("HTTPClientService");for(const f of this.networkConfigs)r.networks.push(f);if(this.startups!=null)for(const f of this.startups)f.InitializeServices(this.container,this.config,this.store);return this}}var V=(i=>(i.string="string",i.number="number",i.boolean="boolean",i.date="date",i.datetime="datetime",i.time="time",i))(V||{});class se{constructor(e){this.dataType=e.dataType,this.name=e.name,this.value=e.value}GetValue(){return this.value}}class Gn extends re{constructor(e){super({propertys:[new se({name:"id",type:V.number}),new se({name:"rootComponent",type:V.object}),new se({name:"components",type:V.array}),new se({name:"selector",type:V.string}),new se({name:"mode",type:V.number}),new se({name:"modules",type:V.array})],name:"ApplicationConfiguration"}),this.selector="#app",Object.assign(this,e)}}function $n(i,e){const t=S.inject("viewGetter_"+i);if(t==null)throw new Error("ViewGetter not found");return t(e)}var at=(i=>(i.Container="Container",i.Component="Component",i))(at||{});class qn{}var ct=(i=>(i.spassr="spassr",i.spaclient="spaclient",i.mpahybrid="mpahybrid",i.mpassr="mpassr",i.electron="electron",i.cordova="cordova",i))(ct||{}),lt=(i=>(i.global="global",i.local="local",i.none="none",i))(lt||{});class kn{constructor(e){Object.assign(this,e)}}class Wn{constructor(){this.value={}}GetParameter(e,t=this.value){if(t.hasOwnProperty(e))return t[e];for(const n in t)if(typeof t[n]=="object"){const r=this.GetParameter(e,t[n]);if(r)return r}}}class Ln{constructor(e){this.config=e}ProvideCreateDIContainer(e){const t=new O.Container;e.InitializeServices(t,this.config),this.container=t}}class Hn{constructor(e,t){this.config=e,this.templateRef=t}setup(){}}class Ie{static Download(e,t){const n="data:text/json;charset=utf-8,"+JSON.stringify(e),r=Ie.SetFileName("export",t);e=encodeURI(n);const o=document.createElement("a");o.setAttribute("href",e),o.setAttribute("download",r),o.click()}static SetFileName(e){return e+".csv"}}var ut=(i=>(i.json="json",i.csv="csv",i.xml="xml",i.yaml="yaml",i))(ut||{}),h=(i=>(i.Equal="Equal",i.NotEqual="NotEqual",i.Contains="Contains",i.Between="Between",i.Greater="Greater",i.GreaterOrEqual="GreaterOrEqual",i.Less="Less",i.LessOrEqual="LessOrEqual",i.StartsWith="StartsWith",i.EndsWith="EndsWith",i.IsNull="IsNull",i.In="In",i.NotIn="NotIn",i))(h||{});class te{constructor(e){Object.assign(this,e),this.type==null&&(this.type=V.string)}SetClearValue(){switch(this.type){case V.string:this.value="";break;case V.number:this.value=0;break;case V.boolean:this.value=!1;break;case V.array:this.value=[];break;case V.object:this.value={};break;case V.date:this.value="";break;case V.datetime:this.value="";break;case V.time:this.value="";break}}ChangeOperator(e){switch(e){case h.Contains:this.operator=h.Contains,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.Equal:this.operator=h.Equal,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.Greater:this.operator=h.Greater,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.GreaterOrEqual:this.operator=h.GreaterOrEqual,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.Less:this.operator=h.Less,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.LessOrEqual:this.operator=h.LessOrEqual,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.NotEqual:this.operator=h.NotEqual,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.StartsWith:this.operator=h.StartsWith,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.EndsWith:this.operator=h.EndsWith,(Array.isArray(this.value)||typeof this.value=="object")&&this.SetClearValue();break;case h.IsNull:this.operator=h.IsNull,(Array.isArray(this.value)||typeof this.value=="object"||typeof this.value!="boolean")&&this.SetClearValue();break;case h.In:this.operator=h.In,Array.isArray(this.value)||this.SetClearValue();break;case h.NotIn:this.operator=h.NotIn,Array.isArray(this.value)||this.SetClearValue();break;case h.Between:this.operator=h.Between,this.value={from:"",to:""};break;default:this.operator=h.Contains;break}}Update(e){this.value=e.value,(e.field!=this.field||e.operator!=this.operator||e.type!=this.type||e.jsCode!=this.jsCode)&&(this.field=e.field,this.operator=e.operator,this.type=e.type,this.jsCode=e.jsCode,this.BuildExpression())}static FromString(e,t,n={operator:h.Contains}){let[r,o]=te.GetOperatorAndValueFromString(e);if(r==null||o==null){if(n.operator==null)throw new Error("Operator cant be found");r=n.operator,o=e}const s=te.ConvertValueToType(o);return new te({value:s,operator:r,field:t,type:typeof s})}static ConvertValueToType(e){return e=="true"?!0:e=="false"?!1:isNaN(Number(e))?e:Number(e)}static CountOperators(e){return e}static CheckStringIsValid(e){return te.CountOperators(e)}static GetFiltersFromString(e){return e}static GetOperatorAndValueFromString(e){const t=/Equals\("?([^"]+)"?\)/g,n=/NotEquals\("([^"]+)"\)/g,r=/Greater\("([^"]+)"\)/g,o=/GreaterOrEqual\("([^"]+)"\)/g,s=/Less\("([^"]+)"\)/g,f=/LessOrEqual\("([^"]+)"\)/g,p=/StartsWith\("([^"]+)"\)/g,g=/EndsWith\("([^"]+)"\)/g,P=/Contains\("([^"]+)"\)/g,D=/In\("([^"]+)"\)/g,T=/NotIn\("([^"]+)"\)/g,j=/Between\("([^"]+)"\)/g,M=/IsNull\(\)/g,B=/IsNotNull\(\)/g;if(t.test(e)==!0){const J=e.replace("Equals(","").replace(")","");return[h.Equal,J]}else{if(n.test(e))return h.NotEqual;if(r.test(e))return h.Greater;if(o.test(e))return h.GreaterOrEqual;if(s.test(e))return h.Less;if(f.test(e))return h.LessOrEqual;if(p.test(e))return h.StartsWith;if(g.test(e))return h.EndsWith;if(P.test(e))return h.Contains;if(D.test(e))return h.In;if(T.test(e))return h.NotIn;if(j.test(e))return h.Between;if(M.test(e))return h.IsNull;if(B.test(e))return h.IsNotNull}return[void 0,void 0]}BuildExpression(){if(this.jsCode)this.expression=this.jsCode;else switch(this.operator){case h.Contains:this.expression=function(e){return e[this.field].includes(this.value)};case h.Equal:this.expression=function(e){return e[this.field]==this.value};case h.Greater:this.expression=function(e){return e[this.field]>this.value};case h.GreaterOrEqual:this.expression=function(e){return e[this.field]>=this.value};case h.Less:this.expression=function(e){return e[this.field]<this.value};case h.LessOrEqual:this.expression=function(e){return e[this.field]<=this.value};case h.NotEqual:this.expression=function(e){return e[this.field]!=this.value};case h.StartsWith:this.expression=function(e){return e[this.field].startsWith(this.value)};case h.EndsWith:this.expression=function(e){return e[this.field].endsWith(this.value)};case h.IsNull:this.expression=function(e){return e[this.field]==null};case h.In:this.expression=function(e){return e[this.field].includes(this.value)};case h.NotIn:this.expression=function(e){return!e[this.field].includes(this.value)};case h.Between:this.expression=function(e){return e[this.field]>=this.value&&e[this.field]<=this.value};default:this.expression=function(){return!0}}}Run(e){return this.expression||this.BuildExpression(),this.expression(e)}}class ae{constructor(e,t){if(this.and=e,(t==null?void 0:t.length)>0)for(const n of t)this.addFilter(n)}addFilter(e){this.filters==null&&(this.filters=[]),e.key==null&&this.SetFilterKey(e),this.filters.push(e)}SetFilterKey(e){const t=this.filters.map(n=>n.key);t.length==0?e.key=0:e.key=Math.max(...t.map(n=>Number(n)))+1}SetChainKey(e){const t=this.subChains.map(n=>n.key);t.length==0?e.key=0:e.key=Math.max(...t.map(n=>Number(n)))+1}removeFilter(e){this.filters=this.filters.splice(this.filters.indexOf(e),1)}static CountAndAndOr(e){const t=e.indexOf("&&"),n=e.indexOf("||");return t!=-1&&n!=-1}static CheckStringIsValid(){}static FromString(e,t={and:!0}){const n=new ae;n.and=t.and;const r=/\{\((.*?)\)\}/g;(!e.startsWith("{(")||!e.endsWith(")}"))&&(e="{("+e+")}");const o=e.indexOf("{("),s=e.lastIndexOf(")}");e=e.substring(o+2,s);const f=new ae,p=e.match(r);if(p!=null&&(p==null?void 0:p.length)>0&&typeof p[Symbol.iterator]=="function")for(const g of p){const P=ae.FromString(g);n.addChild(P)}for(const g of splitFiltersByAndOrOr){const P=te.FromString(g);f.addFilter(P)}return n.addChild(f),console.log(n),n}static RemoveChainStringCrumps(e){const t=e.indexOf("{("),n=e.lastIndexOf(")}");return t==-1||n==-1?e:e.substring(t+2,n)}addChild(e){this.subChains==null&&(this.subChains=[]),this.SetChainKey(e),this.subChains.push(e)}Run(e){if(this.and==!0){for(const t of this.filters)if(t.Run(e)==!1)return!1;for(const t of this.subChains)if(t.Run(e)==!1)return!1}else if(this.and==!1){for(const t of this.filters)if(t.Run(e)==!0)return!0;for(const t of this.subChains)if(t.Run(e)==!0)return!0}return this.filters[0].Run(e)}}class Fn{constructor(){}AddChain(e,t=!0){if(this.filterChain==null){this.filterChain=new ae(t);return}this.filterChain.addChild(e)}Get(e){return this.filterChain==null?e:e.filter(t=>this.filterChain.Run(t))}}function Un(i,e){return new URL(i+e,typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:De&&De.src||new URL("index.umd.cjs",document.baseURI).href).href}function zn(i){return S.getCurrentScope()?(S.onScopeDispose(i),!0):!1}function dt(i){return typeof i=="function"?i():S.unref(i)}const Jn=typeof window<"u"&&typeof document<"u",Qn=Object.prototype.toString,Yn=i=>Qn.call(i)==="[object Object]",Zn=()=>{};function Xn(i){var e;const t=dt(i);return(e=t==null?void 0:t.$el)!=null?e:t}const Kn=Jn?window:void 0;function ei(...i){let e,t,n,r;if(typeof i[0]=="string"||Array.isArray(i[0])?([t,n,r]=i,e=Kn):[e,t,n,r]=i,!e)return Zn;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const o=[],s=()=>{o.forEach(P=>P()),o.length=0},f=(P,D,T,j)=>(P.addEventListener(D,T,j),()=>P.removeEventListener(D,T,j)),p=S.watch(()=>[Xn(e),dt(r)],([P,D])=>{if(s(),!P)return;const T=Yn(D)?{...D}:D;o.push(...t.flatMap(j=>n.map(M=>f(P,j,M,T))))},{immediate:!0,flush:"post"}),g=()=>{p(),s()};return zn(g),g}function ti(i){if(typeof i=="string"&&i!=""){const e=i.match(/^([-.\d]+(?:\.\d+)?)(.*)$/);return e==null?{value:i,unit:""}:{value:e[1].trim(),unit:e[2].trim()}}else return{value:i,unit:""}}function ft(i,e,t){return t==null||t.length==0?[]:t.map(n=>()=>Ae(i,e,n.rule)||n.errorMessage)}class ni extends He{constructor(e){super(e)}ValidateRules(){const{contextProvider:e,contextid:t}=this.ProvideContext();return ft(e,t,this.GetConfiguration().properties.rules)}}var ii=Object.defineProperty,ri=Object.getOwnPropertyDescriptor,oi=(i,e,t,n)=>{for(var r=n>1?void 0:n?ri(e,t):e,o=i.length-1,s;o>=0;o--)(s=i[o])&&(r=(n?s(e,t,r):s(r))||r);return n&&r&&ii(e,t,r),r};a.CSSProvider=class{ProvideThemeAsCSSElement(e,t){let n="";for(const s of e==null?void 0:e.colors)n+=`.text-${s.key} { color: ${s.value}; }`,n+=`.bg-${s.key} { background: ${s.value}; }`;const r=document.getElementById("alpha-theme");r!=null&&r.remove();const o=this.CreateCSSElement(n);t!=null?t.appendChild(o):document.body.appendChild(o)}CreateCSSElement(e){const t=document.createElement("style");return t.id="alpha-theme",t.innerHTML=e,t}},a.CSSProvider=oi([O.injectable()],a.CSSProvider),a.Application=Ln,a.ApplicationConfiguration=Gn,a.ApplicationDeploymentModes=ct,a.ApplicationModes=fe,a.ApplicationModule=qn,a.ApplicationSettings=Wn,a.AxiosWrapper=qe,a.BaseView=Le,a.BaseViewModel=Rt,a.BrowserDownload=Ie,a.BusinessObject=re,a.ContextLevel=X,a.DataAdapterOptions=kn,a.DataSources=Re,a.DataTypes=V,a.DefaultApplicationServiceCollection=ot,a.ExpressionValidator=de,a.FileTypes=ut,a.Filter=te,a.FilterChain=ae,a.FilterOperators=h,a.KeyValuePair=Ve,a.LoggingService=Pt,a.ModellingContextStateManager=Ue,a.Page=Hn,a.PublishScopes=lt,a.Query=Fn,a.RequestMethods=Xe,a.SetValuesAction=Ke,a.SetterActionTargetTypes=Ze,a.SimpleNameValueCollection=Ce,a.SolutionObject=wt,a.SplitStyle=ti,a.StateChangeTypes=$,a.SyncStateModes=ge,a.Transaction=ke,a.UIActionEvent=tn,a.UIActionTargetTypes=Je,a.UIActionTypes=Ye,a.UIActionsEnum=ee,a.UIEventTypes=ye,a.UIEvents=ze,a.UtilityModule=Ct,a.ValueResolver=Ae,a.ValueValidationViewElement=ni,a.ViewConfiguration=en,a.ViewElement=He,a.ViewRoles=at,a.VueApplication=st,a.VueApplicationComponent=tt,a.createUniqueClientIdInContext=Ge,a.deepcopy=et,a.nthIndex=$e,a.searchObjectInNestedArray=Se,a.useApplicationStore=be,a.useCreatorStore=me,a.useDataStore=_e,a.useEventListener=ei,a.useGetFile=Un,a.useModellingStateManagementPlugin=Gt,a.useModellingStore=we,a.useSolutionService=Kt,a.useViewConfiguration=$n,a.useWebNodeStore=z,a.useWebNodeTemplateStore=Vt,a.validateRules=ft,a.waitForElm=Pe,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
